"use strict";(self.webpackChunkdndocs=self.webpackChunkdndocs||[]).push([[2609],{5753:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>l,metadata:()=>o,toc:()=>i});var t=n(5893),s=n(1151);const l={sidebar_position:6},r=void 0,o={id:"For developpers/Addon/PacketHandling",title:"PacketHandling",description:"R\xe9cup\xe9rer les packets entrants",source:"@site/docs/For developpers/Addon/PacketHandling.mdx",sourceDirName:"For developpers/Addon",slug:"/For developpers/Addon/PacketHandling",permalink:"/DreamNetwork-DocumentationV2/docs/For developpers/Addon/PacketHandling",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/For developpers/Addon/PacketHandling.mdx",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Messaging",permalink:"/DreamNetwork-DocumentationV2/docs/For developpers/Addon/Messaging"}},c={},i=[{value:"R\xe9cup\xe9rer les packets entrants",id:"r\xe9cup\xe9rer-les-packets-entrants",level:2}];function d(e){const a={code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.h2,{id:"r\xe9cup\xe9rer-les-packets-entrants",children:"R\xe9cup\xe9rer les packets entrants"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-java",children:"    DNCoreAPI.getInstance().getPacketFactory().registerHandlingClass(HandlePacket.class);\n    // ou\n    DNCoreAPI.getInstance().getPacketFactory().registerHandlingObject(new HandlePacket());\n"})}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-java",children:'@PacketGlobal(header = "MonProjet")\npublic class HandlePacket implements PacketHandler {\n    @PacketHandler(header = "MonPacket")\n    public void onPacket() {\n        // Code\n    }\n\n    @PacketHandler(header = "MonPacket2")\n    public void onPacket2(Message message) {\n        // Code\n\n        // Exemple d\'utilisation\n        String status = message.getString("status");\n        if(status.equals("ok")) {\n            System.out.println("Le status est ok");\n        }else{\n            System.out.println("Le status n\'est pas ok :\'c ");\n        }\n    }\n\n    @PacketHandler(header = "MonPacket3")\n    public void onPacket3(Message message, ContextChannelHandlerContext ctx) {\n        // Code\n    }\n}\n'})}),"\n",(0,t.jsx)(a.p,{children:"Vous pouvez directement voir onPacket2"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-java",children:'@PacketGlobal(header = "MonProjet")\npublic class HandlePacket implements PacketHandler {\n    @PacketHandler\n    public void onPacket2(Message message, String status) {\n        // Code\n        if(status.equals("ok")) {\n            System.out.println("Le status est ok");\n        }else{\n            System.out.println("Le status n\'est pas ok :\'c ");\n        }\n    }\n}\n'})}),"\n",(0,t.jsx)(a.p,{children:"Si vous avez envoy\xe9 un message qui contient un objet qui a \xe9t\xe9 converti manuellement ou automatiquent\nvous pouvez le r\xe9cup\xe9rer directement en le mettant en param\xe8tre, veillez indiquer la cl\xe9 du message via un PacketCast."}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-java",children:'@PacketGlobal(header = "MonProjet")\npublic class HandlePacket implements PacketHandler {\n    @PacketHandler\n    public void onAutoConvert(Message message, @PacketCast(key = "object") MyObject object) {\n        // Code\n        if(myObject.getAge() == 18) {\n            System.out.println("Le joueur a 18 ans");\n        }else{\n            System.out.println("Le joueur n\'a pas 18 ans");\n        }\n    }\n\n    @PacketHandler\n    public void onManualConvert(Message message, @PacketCast(key = "player") Player player) {\n        // Code\n        if(player.getServer().getName().equals("main/lobby")) {\n            System.out.println("Le joueur est dans le lobby");\n        }else{\n            System.out.println("Le joueur n\'est pas dans le lobby");\n        }\n    }\n}\n'})}),"\n",(0,t.jsx)(a.p,{children:'Pour envoyer un message avec le bon "header" vous devez mettre le header du globalPacket et le header du packetHandler s\xe9par\xe9 par un tiret'}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-java",children:'       Message message = new Message("MonProjet-MonPacket").set("message", "SALUT");\n'})}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-java",children:'    @PacketGlobal(header = "MonProjet")\n    public class HandlePacket implements PacketHandler {\n        @PacketHandler(header = "MonPacket")\n        public void onPacket(Message message,@PacketCast(key = "message") String msg) {\n            // Code\n            System.out.println(msg);\n        }\n    }\n'})}),"\n",(0,t.jsx)(a.p,{children:"Vous n'\xeates pas oblig\xe9 d'indiquer le PacketCast m\xeame si cela est une bonne pratique. Par contre il faut que 2 conditions soient respect\xe9es :"}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsx)(a.li,{children:'Le nom du param\xe8tre doit \xeatre le m\xeame que la cl\xe9 de l\'objet dans le message ( donc si vous avez comme nom de param\xe8tre "key", il faut que la cl\xe9 de l\'objet soit "key" ou "Key" ou m\xeame "kEy")\n(Le mode "SMART" est activ\xe9 par d\xe9faut, cela veut dire que si vous avez comme nom de param\xe8tre "key" et que la cl\xe9 de l\'objet est "Key" cela fonctionnera)\nPour le changer vous pouvez le sp\xe9cifier soit dans @PacketGlobal soit @PacketHandler ou m\xeame dans @PacketCast via son param\xe8tre castType -> Exemple:'}),"\n"]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-java",children:"@PacketGlobal(castType = PacketGlobal.PacketType.NORMAL) // -> message specialKey = specialKey -> paramater specialKey = specialKey\n@PacketGlobal(castType = PacketGlobal.PacketType.SMART) // -> message key = key -> paramater key = key ou Key ou kEy\n@PacketGlobal(castType = PacketGlobal.PacketType.PRETTY) // -> message specialKey = specialKey -> paramater specialKey = SpecialKey\n@PacketGlobal(castType = PacketGlobal.PacketType.CAPITALIZED) // -> message specialKey = specialKey -> paramater specialKey = SPECIALKEY\n@PacketGlobal(castType = PacketGlobal.PacketType.LOWERCASE) // -> message specialKey = specialKey -> paramater specialKey = specialkey\n"})}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsx)(a.li,{children:"De plus vous devez sp\xe9cifier \xe0 votre compilateur qu'il faut pouvoir compiler les noms de param\xe8tres de votre code:\nVoici un exemple sur maven:"}),"\n"]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-xml",children:"<plugins>\n  <plugin>\n    <groupId>org.apache.maven.plugins</groupId>\n    <artifactId>maven-compiler-plugin</artifactId>\n    <version>3.8.0</version>\n    <configuration>\n      <compilerArgs>\n        <arg>-parameters</arg>\n      </compilerArgs>\n    </configuration>\n  </plugin>\n</plugins>\n"})}),"\n",(0,t.jsx)(a.p,{children:"Et maintenant c'est bon ! vous pouvez faire comme cela:"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-java",children:'    @PacketGlobal(header = "MonProjet")\n    public class HandlePacket implements PacketHandler {\n        @PacketHandler(header = "MonPacket")\n        public void onPacket(Message message, String message) {\n            // Code\n            System.out.println(msg);\n        }\n    }\n'})})]})}function p(e={}){const{wrapper:a}={...(0,s.a)(),...e.components};return a?(0,t.jsx)(a,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},1151:(e,a,n)=>{n.d(a,{Z:()=>o,a:()=>r});var t=n(7294);const s={},l=t.createContext(s);function r(e){const a=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(l.Provider,{value:a},e.children)}}}]);